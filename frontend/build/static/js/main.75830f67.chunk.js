(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{33:function(e,t,n){},40:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n(1),c=n.n(o),s=n(21),i=n.n(s),r=(n(33),n(26)),p=n(16),u=n.n(p),l=n(22),_=n(3),d=n.p+"static/media/logo.ff16f24b.svg",j=n(2),m=function(e){var t=e.onSignOut,n=e.loggedIn,o=e.email,s=Object(j.h)(),i=Object(j.g)(),r=c.a.useState(!1),p=Object(_.a)(r,2),u=p[0],l=p[1],m=function(){return"/signin"===s.pathname?"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f":"/"===s.pathname?"\u0412\u044b\u0439\u0442\u0438":"\u0412\u043e\u0439\u0442\u0438"};return Object(a.jsxs)("header",{className:"".concat(n&&u?"header page__header header_type_active":"header page__header"),children:[Object(a.jsx)("a",{className:"logo header__logo opacity",href:"../../public/index.html",children:Object(a.jsx)("img",{className:"logo__image",src:d,alt:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f \u0441\u0430\u0439\u0442\u0430 \u041c\u0435\u0441\u0442\u043e"})}),Object(a.jsxs)("div",{className:n&&u?"header__cover header__cover_type_vertical header__cover_type_active":n?n?"header__cover header__cover_type_vertical":void 0:"header__cover",children:[Object(a.jsx)("span",{className:"".concat(n?"header__email header__email_type_active":"header__email"),children:o}),Object(a.jsx)("button",{className:"".concat(n?"header__button header__button_type_log-out opacity":"header__button opacity"),onClick:function(){"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"===m()?i.push("/signup"):"\u0412\u043e\u0439\u0442\u0438"===m()?i.push("/signin"):t()},children:m()})]}),Object(a.jsx)("div",{onClick:function(){l(!u)},className:"".concat(n?"header__menu-wrapper header__menu-wrapper_type_active":"header__menu-wrapper"),children:Object(a.jsx)("div",{className:u?"header__menu header__menu_type_active":"header__menu"})})]})},b=n(11),h=n(7),f=function(e){var t=function(t){return e.reduce((function(e,n){return e[n]=t,e}),{})},n=c.a.useState(t(!1)),a=Object(_.a)(n,2),o=a[0],s=a[1],i=c.a.useState(t("")),r=Object(_.a)(i,2),p=r[0],u=r[1],l=c.a.useState(t("")),d=Object(_.a)(l,2),j=d[0],m=d[1];return{isValid:o,setIsValid:s,inputValue:p,setInputValue:u,validationMessage:j,setValidationMessage:m,handleInputChange:function(e){var t=e.target,n=t.name,a=t.value;u(Object(h.a)(Object(h.a)({},p),{},Object(b.a)({},n,a))),s(Object(h.a)(Object(h.a)({},o),{},Object(b.a)({},n,e.target.validity.valid))),m(Object(h.a)(Object(h.a)({},j),{},Object(b.a)({},n,e.target.validationMessage)))},fieldsEnumeration:t}},O=function(e){var t=e.handleSubmit,n=e.formName,o=e.submitValue,s=f(["email","password"]),i=s.isValid,r=s.setIsValid,p=s.inputValue,u=s.setInputValue,l=s.validationMessage,_=s.setValidationMessage,d=s.handleInputChange,j=s.fieldsEnumeration;return c.a.useEffect((function(){u(j("")),r(j(!1)),_(j(""))}),[u,r,_]),Object(a.jsxs)("form",{className:"form_type_register",action:"#",name:n,onSubmit:function(e){e.preventDefault(),t({email:p.email,password:p.password})},noValidate:!0,children:[Object(a.jsxs)("div",{className:"popup__cover popup__cover_type_register",children:[Object(a.jsxs)("label",{className:"popup__control",children:[Object(a.jsx)("input",{className:"".concat(l.email?"popup__input popup__input_type_email popup__input_type_error":"popup__input popup__input_type_email"),type:"email",name:"email",value:p.email,onChange:d,placeholder:"Email",required:!0}),Object(a.jsx)("span",{className:"".concat(i.email?"popup__error":"popup__error popup__error_type_active"),children:l.email})]}),Object(a.jsxs)("label",{className:"popup__control",children:[Object(a.jsx)("input",{className:"".concat(l.password?"popup__input popup__input_type_password popup__input_type_error":"popup__input popup__input_type_password"),type:"password",name:"password",value:p.password,onChange:d,placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",required:!0}),Object(a.jsx)("span",{className:"".concat(i.password?"popup__error":"popup__error popup__error_type_active"),children:l.password})]})]}),Object(a.jsx)("input",{className:"".concat(i.email&&i.password?"button popup__submit popup__submit_type_white":"button popup__submit popup__submit_type_white popup__submit_type_disabled"),type:"submit",value:o,name:"submit"})]})},v=function(e){var t=e.onLogin,n=e.isLoading,o="".concat(n?"\u0412\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442\u0441\u044f \u0432\u0445\u043e\u0434...":"\u0412\u043e\u0439\u0442\u0438");return Object(a.jsxs)("section",{className:"register",children:[Object(a.jsx)("h2",{className:"popup__title popup__title_type_white",children:"\u0412\u0445\u043e\u0434"}),Object(a.jsx)(O,{handleSubmit:function(e){var n=e.email,a=e.password;n&&a&&t(n,a)},formName:"login",submitValue:o})]})},g=n(9),x=function(e){var t=e.onRegister,n=e.isLoading,o="".concat(n?"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f...":"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f");return Object(a.jsxs)("section",{className:"register",children:[Object(a.jsx)("h2",{className:"popup__title popup__title_type_white",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(a.jsx)(O,{handleSubmit:function(e){var n=e.email,a=e.password;n&&a&&t(n,a)},formName:"register",submitValue:o}),Object(a.jsx)(g.b,{to:"signin",className:"register__link",children:"\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b? \u0412\u043e\u0439\u0442\u0438"})]})},y=c.a.createContext(),N=function(e){var t=e.card,n=e.onCardClick,o=e.onCardLike,s=e.onCardDelete,i=c.a.useContext(y),r=t.owner===i._id,p=t.likes.some((function(e){return e===i._id}));return Object(a.jsxs)("li",{className:"pictures__item",children:[Object(a.jsx)("button",{className:"".concat(r?"button pictures__delete pictures__delete_show opacity":"button pictures__delete opacity"),type:"button",onClick:function(){s(t)}}),Object(a.jsx)("img",{className:"pictures__image",src:t.link,alt:t.name,onClick:function(){n(t)}}),Object(a.jsxs)("div",{className:"pictures__cover",children:[Object(a.jsx)("p",{className:"pictures__title",children:t.name}),Object(a.jsxs)("div",{className:"pictures__like-cover",children:[Object(a.jsx)("button",{className:"".concat(p?"button pictures__like pictures__like_active opacity":"button pictures__like opacity"),type:"button",onClick:function(){o(t)}}),Object(a.jsx)("span",{className:"pictures__like-counter",children:t.likes.length})]})]})]})},k=function(e){var t=e.onEditAvatar,n=e.onEditProfile,o=e.onAddPlace,s=e.onCardClick,i=e.onCardLike,r=e.onCardDelete,p=e.cards,u=c.a.useContext(y);return Object(a.jsxs)("main",{className:"content page__content",children:[Object(a.jsxs)("section",{className:"profile",children:[Object(a.jsxs)("div",{className:"profile__cover",children:[Object(a.jsx)("div",{className:"avatar profile__avatar",onClick:t,style:{backgroundImage:"url(".concat(u.avatar,")")}}),Object(a.jsxs)("div",{className:"profile__info",children:[Object(a.jsxs)("div",{className:"profile__position",children:[Object(a.jsx)("h1",{className:"profile__title",children:u.name}),Object(a.jsx)("button",{className:"button button_edit profile__button opacity",type:"button",onClick:n})]}),Object(a.jsx)("p",{className:"profile__subtitle",children:u.about})]})]}),Object(a.jsx)("button",{className:"button button_add opacity",type:"button",onClick:o})]}),Object(a.jsx)("section",{className:"pictures",children:Object(a.jsx)("ul",{className:"pictures__list",children:p.map((function(e){return Object(a.jsx)(N,{onCardClick:s,card:e,onCardLike:i,onCardDelete:r},e._id)}))})})]})},C=function(){return Object(a.jsx)("footer",{className:"footer page__footer",children:Object(a.jsx)("p",{className:"footer__copyright",children:"\xa9 2021 Mesto Russia"})})},S=function(e){var t=e.name,n=e.isOpen,o=e.onClose,s=e.children,i=function(e){"Escape"===e.key&&o()};c.a.useEffect((function(){return document.addEventListener("keydown",i,!1),function(){document.removeEventListener("keydown",i,!1)}}),[n]);return Object(a.jsx)("section",{className:"".concat(n?"popup popup_type_".concat(t," popup_opened"):"popup popup_type_".concat(t)),onMouseUp:function(e){e.target===e.currentTarget&&n&&o()},children:Object(a.jsxs)("div",{className:function(e){return"picture"===e?"popup__container popup__container_type_picture":"info"===e?"popup__container popup__container_type_info":"popup__container"}(t),children:[Object(a.jsx)("button",{className:"".concat("info"===t?"button popup__close popup__close_type_info opacity":"button popup__close opacity"),type:"button",onClick:o}),s]})})},w=function(e){var t=e.isOpen,n=e.onClose,o=e.onUpdateUser,s=e.isLoading,i=f(["name","about"]),r=i.isValid,p=i.setIsValid,u=i.inputValue,l=i.setInputValue,_=i.validationMessage,d=i.setValidationMessage,j=i.handleInputChange,m=i.fieldsEnumeration,b=c.a.useContext(y);return c.a.useEffect((function(){l({name:b.name||"",about:b.about||""}),p(m(!0)),d(m(""))}),[b,t,l,p,d]),Object(a.jsxs)(S,{name:"edit",isOpen:t,onClose:n,children:[Object(a.jsx)("h2",{className:"popup__title",children:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c"}),Object(a.jsxs)("form",{className:"popup__form form_type_edit",action:"#",name:"edit",onSubmit:function(e){e.preventDefault(),o({name:u.name,about:u.about})},noValidate:!0,children:[Object(a.jsxs)("div",{className:"popup__cover",children:[Object(a.jsxs)("label",{className:"popup__control",children:[Object(a.jsx)("input",{className:"".concat(_.name?"popup__input popup__input_type_name popup__input_type_error":"popup__input popup__input_type_name"),type:"text",name:"name",value:u.name,onChange:j,placeholder:"\u0418\u043c\u044f",minLength:"2",maxLength:"20",pattern:"^[A-Za-z\u0410-\u042f\u0430-\u044f\u0401\u0451\\D][A-Za-z\u0410-\u042f\u0430-\u044f\u0401\u0451\\s\\D]*[A-Za-z\u0410-\u042f\u0430-\u044f\u0401\u0451\\D]$",required:!0}),Object(a.jsx)("span",{className:"".concat(r.name?"popup__error":"popup__error popup__error_type_active"),children:_.name})]}),Object(a.jsxs)("label",{className:"popup__control",children:[Object(a.jsx)("input",{className:"".concat(_.about?"popup__input popup__input_type_about popup__input_type_error":"popup__input popup__input_type_about"),type:"text",name:"about",value:u.about,onChange:j,placeholder:"\u0417\u0430\u043d\u044f\u0442\u0438\u0435",minLength:"2",maxLength:"200",pattern:"^[A-Za-z\u0410-\u042f\u0430-\u044f\u0401\u0451\\D][A-Za-z\u0410-\u042f\u0430-\u044f\u0401\u0451\\s\\D]*[A-Za-z\u0410-\u042f\u0430-\u044f\u0401\u0451\\D]$",required:!0}),Object(a.jsx)("span",{className:"".concat(r.about?"popup__error":"popup__error popup__error_type_active"),children:_.about})]})]}),Object(a.jsx)("input",{className:"".concat(r.name&&r.about?"button popup__submit":"button popup__submit popup__submit_type_disabled"),type:"submit",value:"".concat(s?"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),name:"submit"})]})]})},V=function(e){var t=e.isOpen,n=e.onClose,o=e.onUpdateAvatar,s=e.isLoading,i=f(["avatar"]),r=i.isValid,p=i.setIsValid,u=i.inputValue,l=i.setInputValue,_=i.validationMessage,d=i.setValidationMessage,j=i.handleInputChange,m=i.fieldsEnumeration,b=c.a.useRef(null);return c.a.useEffect((function(){l(m("")),p(m(!1)),d(m(""))}),[t,l,p,d]),Object(a.jsxs)(S,{name:"avatar",isOpen:t,onClose:n,children:[Object(a.jsx)("h2",{className:"popup__title",children:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440"}),Object(a.jsxs)("form",{className:"popup__form form_type_avatar",action:"#",name:"avatar",onSubmit:function(e){e.preventDefault(),o({avatar:b.current.value})},noValidate:!0,children:[Object(a.jsx)("div",{className:"popup__cover popup__cover_type_avatar",children:Object(a.jsxs)("label",{className:"popup__control",children:[Object(a.jsx)("input",{ref:b,className:"".concat(_.avatar?"popup__input popup__input_type_avatar popup__input_type_error":"popup__input popup__input_type_avatar"),type:"url",name:"avatar",value:u.avatar,placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",onChange:j,required:!0}),Object(a.jsx)("span",{className:"".concat(r.avatar?"popup__error":"popup__error popup__error_type_active"),children:_.avatar})]})}),Object(a.jsx)("input",{className:"".concat(r.avatar?"button popup__submit":"button popup__submit popup__submit_type_disabled"),type:"submit",value:"".concat(s?"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),name:"submit"})]})]})},I=function(e){var t=e.isOpen,n=e.onClose,o=e.onAddPlace,s=e.isLoading,i=f(["name","link"]),r=i.isValid,p=i.setIsValid,u=i.inputValue,l=i.setInputValue,_=i.validationMessage,d=i.setValidationMessage,j=i.handleInputChange,m=i.fieldsEnumeration;return c.a.useEffect((function(){l(m("")),p(m(!1)),d(m(""))}),[t,l,p,d]),Object(a.jsxs)(S,{name:"add",isOpen:t,onClose:n,children:[Object(a.jsx)("h2",{className:"popup__title",children:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e"}),Object(a.jsxs)("form",{className:"popup__form form_type_add",action:"#",name:"add",onSubmit:function(e){e.preventDefault(),o({name:u.name,link:u.link})},noValidate:!0,children:[Object(a.jsxs)("div",{className:"popup__cover",children:[Object(a.jsxs)("label",{className:"popup__control",children:[Object(a.jsx)("input",{className:"".concat(_.name?"popup__input popup__input_type_title popup__input_type_error":"popup__input popup__input_type_title"),type:"text",name:"name",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",minLength:"1",maxLength:"30",pattern:"^[A-Za-z\u0410-\u042f\u0430-\u044f\u0401\u0451\\D][A-Za-z\u0410-\u042f\u0430-\u044f\u0401\u0451\\s\\D]*[A-Za-z\u0410-\u042f\u0430-\u044f\u0401\u0451\\D]$",required:!0,value:u.name,onChange:j}),Object(a.jsx)("span",{className:"".concat(r.name?"popup__error":"popup__error popup__error_type_active"),children:_.name})]}),Object(a.jsxs)("label",{className:"popup__control",children:[Object(a.jsx)("input",{className:"".concat(_.link?"popup__input popup__input_type_link popup__input_type_error":"popup__input popup__input_type_link"),type:"url",name:"link",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:!0,value:u.link,onChange:j}),Object(a.jsx)("span",{className:"".concat(r.link?"popup__error":"popup__error popup__error_type_active"),children:_.link})]})]}),Object(a.jsx)("input",{className:"".concat(r.link&&r.name?"button popup__submit":"button popup__submit popup__submit_type_disabled"),type:"submit",value:"".concat(s?"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),name:"submit"})]})]})},E=function(e){var t=e.card,n=e.onClose,o=e.isOpen,c=e.onCardDelete,s=e.isLoading;return Object(a.jsxs)(S,{name:"prevent",isOpen:o,onClose:n,children:[Object(a.jsx)("h2",{className:"popup__title",children:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?"}),Object(a.jsx)("form",{className:"popup__form form_type_prevent",action:"#",name:"prevent",onSubmit:function(e){e.preventDefault(),c(t)},noValidate:!0,children:Object(a.jsx)("input",{className:"button popup__submit",type:"submit",name:"submit",value:"".concat(s?"\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435...":"\u0414\u0430")})})]})},L=function(e){var t=e.card,n=e.isOpen,o=e.onClose;return Object(a.jsx)(S,{name:"picture",isOpen:n,onClose:o,children:Object(a.jsxs)("figure",{className:"popup__figure",children:[Object(a.jsx)("img",{className:"popup__image",src:t.link,alt:t.name}),Object(a.jsx)("figcaption",{className:"popup__caption",children:t.name})]})})},A=n.p+"static/media/success.1b6082f8.svg",P=n.p+"static/media/error.df8eddf6.svg",U=function(e){var t=e.isRegister,n=e.isOpen,o=e.onClose;return Object(a.jsxs)(S,{name:"info",isOpen:n,onClose:o,children:[Object(a.jsx)("img",{className:"popup__icon",src:"".concat("".concat(t?A:P)),alt:"\u0417\u043d\u0430\u0447\u043e\u043a \u043e\u0431 \u0443\u0441\u043f\u0435\u0448\u043d\u043e\u0439 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438 \u043b\u0438\u0431\u043e \u043e\u0448\u0438\u0431\u043a\u0435"}),Object(a.jsx)("h2",{className:"popup__title popup__title_type_center",children:"".concat(t?"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c!":"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a!\n\u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437.")})]})},D=n(24),M=n(25),T="jwt",z=function(e){return localStorage.setItem(T,e)},H=function(){return localStorage.getItem(T)},Z=new(function(){function e(t){var n=t.baseUrl,a=t.headers;Object(D.a)(this,e),this.baseUrl=n,this.headers=a}return Object(M.a)(e,[{key:"getHeaders",value:function(){var e=H();return Object(h.a)(Object(h.a)({},this.headers),{},{Authorization:"Bearer ".concat(e)})}},{key:"getUserInfo",value:function(){return fetch("".concat(this.baseUrl,"users/me"),{headers:this.getHeaders()}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"getCards",value:function(){return fetch("".concat(this.baseUrl,"cards"),{headers:this.getHeaders()}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"setUserInfo",value:function(e){return fetch("".concat(this.baseUrl,"users/me"),{method:"PATCH",headers:this.getHeaders(),body:JSON.stringify({name:e.name,about:e.about})}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"createCard",value:function(e){return fetch("".concat(this.baseUrl,"cards"),{method:"POST",headers:this.getHeaders(),body:JSON.stringify({name:e.name,link:e.link})}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"deleteCard",value:function(e){return fetch("".concat(this.baseUrl,"cards/").concat(e),{method:"DELETE",headers:this.getHeaders()}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"likeCard",value:function(e){return fetch("".concat(this.baseUrl,"cards/").concat(e,"/likes"),{method:"PUT",headers:this.getHeaders()}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"dislikeCard",value:function(e){return fetch("".concat(this.baseUrl,"cards/").concat(e,"/likes"),{method:"DELETE",headers:this.getHeaders()}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"setAvatar",value:function(e){return fetch("".concat(this.baseUrl,"users/me/avatar"),{method:"PATCH",headers:this.getHeaders(),body:JSON.stringify(e)}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}}]),e}())({baseUrl:"https://api.mestobm.students.nomoreparties.xyz/",headers:{"Content-Type":"application/json"}}),q=n(27),J=function(e){var t=e.loggedIn,n=Object(q.a)(e,["loggedIn"]);return t?Object(a.jsx)(j.b,Object(h.a)({},n)):Object(a.jsx)(j.a,{to:"./sign-in"})},R="https://api.mestobm.students.nomoreparties.xyz",B=function(){var e=c.a.useState(!1),t=Object(_.a)(e,2),n=t[0],o=t[1],s=c.a.useState(!1),i=Object(_.a)(s,2),p=i[0],d=i[1],b=c.a.useState(!1),h=Object(_.a)(b,2),f=h[0],O=h[1],g=c.a.useState(!1),N=Object(_.a)(g,2),S=N[0],A=N[1],P=c.a.useState(!1),D=Object(_.a)(P,2),M=D[0],q=D[1],B=c.a.useState(!1),$=Object(_.a)(B,2),G=$[0],F=$[1],K=c.a.useState([]),Q=Object(_.a)(K,2),W=Q[0],X=Q[1],Y=c.a.useState([]),ee=Object(_.a)(Y,2),te=ee[0],ne=ee[1],ae=c.a.useState(!1),oe=Object(_.a)(ae,2),ce=oe[0],se=oe[1],ie=c.a.useState(!1),re=Object(_.a)(ie,2),pe=re[0],ue=re[1],le=c.a.useState(!1),_e=Object(_.a)(le,2),de=_e[0],je=_e[1],me=c.a.useState(!1),be=Object(_.a)(me,2),he=be[0],fe=be[1],Oe=c.a.useState(""),ve=Object(_.a)(Oe,2),ge=ve[0],xe=ve[1],ye=Object(j.g)(),Ne=function(e){return function(e){return fetch("".concat(R,"/users/me"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then((function(e){var t=e.json();return e.ok?t:Promise.reject(e.status)}))}(e).then((function(e){xe(e.email),je(!0),ye.push("/")}))};c.a.useEffect((function(){!function(){var e=H();e&&Ne(e).catch((function(e){401===e&&console.log("\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430, \u0442\u043e\u043a\u0435\u043d \u043d\u0435 \u0431\u044b\u043b \u043f\u0435\u0440\u0435\u0434\u0430\u043d, \u0431\u044b\u043b \u043f\u0435\u0440\u0435\u0434\u0430\u043d \u043d\u0435 \u0432 \u0442\u043e\u043c \u0444\u043e\u0440\u043c\u0430\u0442\u0435 \u0438\u043b\u0438 \u043d\u0435 \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u043c")}))}()}),[]);var ke=function(){var e=Object(l.a)(u.a.mark((function e(){var t,n,a,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Promise.all([Z.getUserInfo(),Z.getCards()]);case 3:t=e.sent,n=Object(_.a)(t,2),a=n[0],o=n[1],ne(o),X(a),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.log("".concat(e.t0));case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}();c.a.useEffect((function(){de&&ke()}),[de]);var Ce=function(){o(!1),d(!1),O(!1),A(!1),F(!1),q(!1),ue(!1)};return Object(a.jsx)("div",{className:"page",children:Object(a.jsxs)("div",{className:"page__cover",children:[Object(a.jsx)(j.d,{children:Object(a.jsxs)(y.Provider,{value:W,children:[Object(a.jsx)(m,{onSignOut:function(){localStorage.removeItem(T),xe(""),je(!1),ye.push("/signin")},loggedIn:de,email:ge}),Object(a.jsx)(j.b,{path:"/signin",children:Object(a.jsx)(v,{onLogin:function(e,t){(function(e,t){return fetch("".concat(R,"/signin"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then((function(e){var t=e.json();return e.ok?t:Promise.reject(e.status)})).then((function(e){if(e.token)return z(e.token),e}))})(e,t).then((function(e){e&&e.token&&(z(e.token),Ne(e.token))})).catch((function(e){400===e?console.log("\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430, \u043d\u0435 \u043f\u0435\u0440\u0435\u0434\u0430\u043d\u043e \u043e\u0434\u043d\u043e \u0438\u0437 \u043f\u043e\u043b\u0435\u0439"):401===e&&console.log("\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430, \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0441 \u0434\u0430\u043d\u043d\u044b\u043c email \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d")}))},isLoading:ce})}),Object(a.jsx)(j.b,{path:"/signup",children:Object(a.jsx)(x,{onRegister:function(e,t){(function(e,t){return fetch("".concat(R,"/signup"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then((function(e){var t=e.json();return e.ok?t:Promise.reject(e.status)}))})(e,t).then((function(e){400!==e.statusCode&&(fe(!0),ue(!0),ye.push("/signin"))})).catch((function(e){fe(!1),ue(!0),400===e&&console.log("\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430, \u043d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u043e \u043e\u0434\u043d\u043e \u0438\u0437 \u043f\u043e\u043b\u0435\u0439")}))},isLoading:ce})}),Object(a.jsxs)(J,{exact:!0,path:"/",loggedIn:"loggedIn",children:[Object(a.jsx)(k,{onEditAvatar:function(){o(!0)},onEditProfile:function(){d(!0)},onAddPlace:function(){O(!0)},onCardClick:function(e){q(!0),F(e)},onCardLike:function(e){(e.likes.some((function(e){return e===W._id}))?Z.dislikeCard(e._id):Z.likeCard(e._id)).then((function(t){var n=te.map((function(n){return n._id===e._id?t:n}));ne(n)})).catch((function(e){console.log("".concat(e))}))},onCardDelete:function(e){A(!0),F(e)},cards:te}),Object(a.jsx)(C,{}),Object(a.jsx)(w,{isOpen:p,onClose:Ce,onUpdateUser:function(e){se(!0),Z.setUserInfo(e).then((function(e){X(e),console.log(e),Ce()})).catch((function(e){console.log("".concat(e))})).finally((function(){se(!1)}))},isLoading:ce}),Object(a.jsx)(I,{isOpen:f,onClose:Ce,onAddPlace:function(e){se(!0),Z.createCard(e).then((function(e){ne([].concat(Object(r.a)(te),[e])),Ce()})).catch((function(e){console.log("".concat(e))})).finally((function(){se(!1)}))},isLoading:ce}),Object(a.jsx)(V,{isOpen:n,onClose:Ce,onUpdateAvatar:function(e){se(!0),Z.setAvatar(e).then((function(e){X(e),Ce()})).catch((function(e){console.log("".concat(e))})).finally((function(){se(!1)}))},isLoading:ce}),Object(a.jsx)(E,{isOpen:S,onClose:Ce,card:G,onCardDelete:function(e){se(!0),Z.deleteCard(e._id).then((function(){var t=te.filter((function(t){return t._id!==e._id}));ne(t),Ce()})).catch((function(e){console.log("".concat(e))})).finally((function(){se(!1)}))},isLoading:ce}),Object(a.jsx)(L,{isOpen:M,onClose:Ce,card:G})]}),Object(a.jsx)(j.b,{children:de?Object(a.jsx)(j.a,{to:"/"}):Object(a.jsx)(j.a,{to:"/signin"})})]})}),Object(a.jsx)(U,{isRegister:he,isOpen:pe,onClose:Ce})]})})};i.a.render(Object(a.jsx)(c.a.StrictMode,{children:Object(a.jsx)(g.a,{children:Object(a.jsx)(B,{})})}),document.getElementById("root"))}},[[40,1,2]]]);
//# sourceMappingURL=main.75830f67.chunk.js.map